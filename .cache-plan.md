# Caching Implementation Plan

## Overview

Add caching to avoid regenerating content when source data hasn't changed.

## Cache Structure

```
.cache/
  ├── feeds/
  │   ├── cli-releases.json          # Raw CLI release feed data
  │   ├── sdk-releases.json          # Raw SDK release feed data  
  │   ├── changelog.json              # Raw changelog feed data
  │   └── blog.json                   # Raw blog feed data
  ├── generated/
  │   ├── cli-summary.json            # Generated CLI summary + source hash
  │   ├── sdk-summary.json            # Generated SDK summary + source hash
  │   ├── news.json                   # Generated news section + source hash
  │   └── welcome.json                # Generated welcome summary + source hash
  └── .gitignore                      # Ignore cache directory
```

## Implementation Steps

### 1. CacheService (✓ Created)

- Hash content using SHA256
- Save/load cached items with source hash
- Compare hashes to determine if regeneration needed

### 2. Refactor NewsletterService

Current: `GenerateReleaseSectionAsync(cli, sdk)` → monolithic

New structure:

- `GenerateProjectReleaseAsync(product, releases, weekStart, weekEnd, cache)` → generic method
- Call twice: once for CLI, once for SDK
- Each checks cache before generating
- Combine results into single "Project updates" section

### 3. Add Caching to All Generation Methods

- `GenerateWelcomeSummaryAsync` → check cache based on news+releases hash
- `GenerateNewsAndAnnouncementsAsync` → check cache based on changelog+blog hash
- `GenerateProjectReleaseAsync` → check cache based on releases hash (per product)

### 4. Update Program.cs Flow

```
1. Fetch all feeds
2. Check if CLI releases changed → use cached CLI summary or regenerate
3. Check if SDK releases changed → use cached SDK summary or regenerate  
4. Check if changelog+blog changed → use cached news or regenerate
5. Check if any inputs changed → use cached welcome or regenerate
6. Combine all sections
```

## Benefits

- Faster iterations when only some sections change
- Reduced AI API calls
- Deterministic output when sources haven't changed
- Easy to invalidate specific sections

## Cache Invalidation

- Automatic: hash mismatch triggers regeneration
- Manual: delete .cache/ directory to force full regeneration
- Per-section: delete specific cache file to regenerate just that section
